<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    
    <t t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension">
        <!-- Información requerida por la SAT -->
        <xpath expr="//*[@class='pos-receipt-contact']" position="after">
            <div class="pos-receipt-contact" style="font-size: 100%;">
                <t t-esc="receipt.company.name"/><br/>
                NIT: <t t-esc="receipt.company.vat"/><br/>
                <br/>
                <t t-if="env.pos.diario_facturacion">
                    <t t-esc="env.pos.diario_facturacion.nombre"/><br/>
                    <t t-esc="env.pos.diario_facturacion.direccion"/><br/>
                    <t t-esc="env.pos.diario_facturacion.phone or ''"/><br/>
                </t>
                <br/>
                <t t-if="fel.firma_fel">
                    Documento Tributario Electrónico FEL<br/>
                    Factura Electrónica<br/>
                    Serie: <t t-esc="fel.serie_fel || ''"/><br/>
                    Número: <t t-esc="fel.numero_fel || ''"/><br/>
                </t>
                <br/>
                <div class="datos_factura">
                    Fecha: <t t-esc="fel.fecha_pedido"/><br/>
                    Empleado: <t t-esc="receipt.cashier"/><br/>
                    <t t-if="receipt.partner">
                        <br/>
                        NIT: <t t-esc="receipt.partner.vat ? receipt.partner.vat : 'CF'"/><br/>
                        Nombre: <t t-esc="receipt.partner.name"/><br/>
                        Dirección: <t t-esc="receipt.partner.street"/><br/><br/>
                    </t>
                </div>
            </div>
        </xpath>

        <!-- Para las facturas que tienen negativos -->
        <xpath expr="//*[@class='pos-receipt-amount']" position="before">
            <div>
                <div>Subtotal: <span t-esc='env.pos.format_currency_no_symbol(receipt.total_with_tax + fel.precio_total_descuento)' class="pos-receipt-right-align"/></div>
                <div>Descuento: <span t-esc='env.pos.format_currency_no_symbol(fel.precio_total_descuento)' class="pos-receipt-right-align"/></div>
            </div>
        </xpath>
        
        <!-- Información del certificador -->
        <xpath expr="//*[@class='before-footer']" position="after">
            <br/>
            <t t-if="fel.certificador_fel == 'infile' || !fel.certificador_fel">
                Certificador<br/>
                INFILE, S.A.<br/>
                NIT: 12521337<br/>
            </t>
            <t t-if="fel.certificador_fel == 'g4s'">
                Certificador<br/>
                G4S DOCUMENTA, S. A.<br/>
                NIT: 60010207<br/>
            </t>
            <t t-if="fel.certificador_fel == 'gom'">
                Certificador<br/>
                GOM SOLUTIONS, SOCIEDAD ANONIMA<br/>
                NIT: 95189416<br/>
            </t>
            <t t-if="fel.certificador_fel == 'ecofactura'">
                Certificador<br/>
                ECO-FACTURAS<br/>
                NIT: 64281167<br/>
            </t>
            <t t-if="fel.certificador_fel == 'digifact'">
                Certificador<br/>
                DIGIFACT SERVICIOS, SOCIEDAD ANONIMA<br/>
                NIT: 77454820<br/>
            </t>
            <t t-if="fel.certificador_fel == 'ccg'">
                Certificador<br/>
                Cámara de Comercio de Guatemala<br/>
                NIT: 351598<br/>
            </t>
            <t t-if="fel.certificador_fel == 'megaprint'">
                Certificador<br/>
                MEGAPRINT, S.A.<br/>
                NIT: 50510231<br/>
            </t>
            <t t-if="fel.certificador_fel == 'totaldoc'">
                Certificador<br/>
                Grupo CDS, S.A.<br/>
                NIT: 107902281<br/>
            </t>
            <t t-if="fel.firma_fel">
                Autorización: <t t-esc="fel.firma_fel || ''"/><br/>
                Fecha Certificación: <t t-esc="fel.fecha_pedido"/>
            </t>
            <div t-if='!receipt.footer and !receipt.footer_html'>
                Sujeto a pagos trimestrales ISR<br/>
            </div>
        </xpath>
     </t>
     
</templates>
